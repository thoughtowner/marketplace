<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Каталог магазина</title>
</head>
<body>
    <div id="shopInfo"></div>

    <script>
        const shopId = window.location.pathname.split('/')[2];
        
        fetch(`/api/shops/${shopId}`)
            .then(response => response.json())
            .then(data => {
                if (!data.shop || !data.catalog || data.catalog.length === 0) {
                    document.getElementById('shopInfo').innerHTML = '<p>Информация о магазине не найдена или магазин пуст.</p>';
                } else {
                    const titleElement = document.createElement('h2');
                    titleElement.textContent = `Каталог магазина "${data.shop.title}"`;

                    const productItems = data.catalog.map(product => {
                        return `
                            <div class="product-item" style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                                <a href="/shops/${shopId}/products/${product.id}">
                                    <img src="${product.photo}" alt="${product.title}" style="width: 200px; height: 200px; object-fit: cover; margin-bottom: 10px;">
                                </a>
                                <p><strong>Название:</strong> ${product.title}</p>
                                <p><strong>Цена:</strong> ${product.price} руб.</p>
                                <p><strong>Общее количество:</strong> ${product.totalQuantity} штук</p>
                                <p><strong>Доступно к покупке:</strong> ${product.totalQuantity - product.quantityInCarts} штук</p>
                            </div>
                        `;
                    }).join('');

                    const shopInfoDiv = document.createElement('div');
                    shopInfoDiv.id = 'shopInfo';
                    shopInfoDiv.appendChild(titleElement);
                    shopInfoDiv.innerHTML += productItems;

                    document.getElementById('shopInfo').innerHTML = '';
                    document.getElementById('shopInfo').appendChild(shopInfoDiv);

                    document.title = `Каталог магазина ${data.shop.title}`;
                }
            })
            .catch(error => {
                console.error('Ошибка при получении данных:', error);
                document.getElementById('shopInfo').innerHTML = '<p>Не удалось загрузить информацию о магазине.</p>';
            });
    </script>

    <div>
        <a href="/account" class="btn btn-link">Личный кабинет</a>
    </div>
    <div>
        <a href="/shops" class="btn btn-link">Вернуться к магазинам</a>
    </div>
</body>
</html>
